<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qf.examsys.dao.QuestionDao">

    <resultMap id="findAllSubject" type="com.qf.examsys.entity.Subject">
        <id property="sid" column="s_id"></id>
        <result property="sName" column="s_name"></result>
    </resultMap>

    <select id="findAllSubject" resultMap="findAllSubject">
        select * from t_subject
    </select>


    <resultMap id="findAllChoose1" type="com.qf.examsys.entity.Choose">
        <id property="cid" column="c_id"></id>
        <result property="cTitle" column="c_title"></result>
        <result property="cOptionA" column="c_option_a"></result>
        <result property="cOptionB" column="c_option_b"></result>
        <result property="cOptionC" column="c_option_c"></result>
        <result property="cOptionD" column="c_option_d"></result>
        <result property="cAnswer" column="c_answer"></result>
        <result property="sid" column="s_id"></result>
        <result property="cScore" column="c_score"></result>

        <association property="subject" javaType="com.qf.examsys.entity.Subject">
            <id property="sid" column="s_id"></id>
            <result property="sName" column="s_name"></result>
        </association>
    </resultMap>

    <select id="findAllChoose" resultMap="findAllChoose1">
        SELECT tc.c_id,tc.c_title,tc.c_option_a,tc.c_option_b,tc.c_option_c,tc.c_option_d,tc.c_answer,tc.c_score,ts.s_name
        from t_choose tc
        LEFT JOIN t_subject ts ON tc.s_id=ts.s_id
        <where>
            <if test="cTitle != null and cTitle != ''">
                and tc.c_title like CONCAT('%','${cTitle}','%')
            </if>

            <if test="sid != null and sid != ''">
                and ts.s_id=#{sid}
            </if>
        </where>
    </select>


    <select id="findQuestionById" resultMap="findAllChoose1">
        select * from t_choose where c_id = #{cid};
    </select>


    <update id="updateQuestionById" parameterType="com.qf.examsys.entity.Choose">
        update t_choose set
        c_title= #{cTitle},c_option_a=#{cOptionA},c_option_b=#{cOptionB},c_option_c=#{cOptionC},c_option_d=#{cOptionD},c_answer=#{cAnswer},c_score=#{cScore}
        where c_id=#{cid}
    </update>

</mapper>